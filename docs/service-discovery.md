# 服务发现协议

## 概述
本协议用于在局域网内自动发现服务端设备，支持Python、TypeScript和Rust实现。协议基于UDP广播，使用HMAC-SHA256进行身份验证。

## 协议规范
### 发现请求包 (28字节)
```
0-15: 设备ID (16字节)
16-19: 随机数 (4字节)
20-27: 时间戳 (8字节, big-endian)
```

### 发现响应包 (66字节)
```
0-27: 原始请求 (28字节)
28-31: IP地址 (4字节)
32-33: WebSocket端口 (2字节, big-endian)
34-65: HMAC签名 (32字节)
```

## 安全设计
- 客户端掌握最终验证权，HMAC签名不会在请求时发送
- 服务端必须在响应中包含HMAC签名供客户端验证
- 时间窗口验证(±30秒)防止重放攻击